(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10590,        289]
NotebookOptionsPosition[      9908,        270]
NotebookOutlinePosition[     10319,        286]
CellTagsIndexPosition[     10276,        283]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "1"},
         {"1", "0"}
        }], "\[NoBreak]", ")"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", 
          RowBox[{"-", "\[ImaginaryI]"}]},
         {"\[ImaginaryI]", "0"}
        }], "\[NoBreak]", ")"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0"},
         {"0", 
          RowBox[{"-", "1"}]}
        }], "\[NoBreak]", ")"}]}], "}"}]}], ";", " ", 
   RowBox[{"Id", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0"},
       {"0", "1"}
      }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Matrix", " ", "implementation"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ssm", "[", 
    RowBox[{"a_", ",", "i_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Sigma]a", ",", "i\[Psi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sigma]a", "=", 
       RowBox[{"{", 
        RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i\[Psi]", "=", "L"}], ",", 
        RowBox[{"i\[Psi]", ">", "i"}], ",", 
        RowBox[{"i\[Psi]", "--"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Sigma]a", "=", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"\[Sigma]a", ",", "Id"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]a", "=", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]a", ",", 
         RowBox[{"\[Sigma]s", "[", 
          RowBox[{"[", "a", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i\[Psi]", "=", 
         RowBox[{"i", "-", "1"}]}], ",", 
        RowBox[{"i\[Psi]", "\[GreaterEqual]", "1"}], ",", 
        RowBox[{"i\[Psi]", "--"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Sigma]a", "=", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"\[Sigma]a", ",", "Id"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[Sigma]a"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.846054746436551*^9, 3.846054758689333*^9}, {
   3.846054841925749*^9, 3.84605493760248*^9}, {3.846054978814803*^9, 
   3.8460550074460382`*^9}, {3.846055048985506*^9, 3.8460550633652115`*^9}, {
   3.846055111836319*^9, 3.8460552317733946`*^9}, {3.846055307524617*^9, 
   3.8460553703638268`*^9}, {3.8460554479688683`*^9, 
   3.8460557461281147`*^9}, {3.846055804762884*^9, 3.846055836733515*^9}, {
   3.8460560481439314`*^9, 3.846056308428502*^9}, 3.8534969183633804`*^9, {
   3.8534971426002254`*^9, 3.8534971686258507`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"1611066d-f182-4e7e-9a85-52540d88081a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H0", "[", 
   RowBox[{"L_", ",", "J_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"in", "=", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"i", ",", "L"}], "]"}], "+", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"[", "i", "]"}], "]"}], 
      RowBox[{
       RowBox[{"ssm", "[", 
        RowBox[{"3", ",", "i", ",", "L"}], "]"}], ".", 
       RowBox[{"ssm", "[", 
        RowBox[{"3", ",", "in", ",", "L"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H1", "[", 
    RowBox[{"L_", ",", "h_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"h", " ", 
      RowBox[{"ssm", "[", 
       RowBox[{"1", ",", "i", ",", "L"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H2", "[", 
   RowBox[{"L_", ",", "J2_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"in", "=", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"i", "+", "1"}], ",", "L"}], "]"}], "+", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"J2", " ", 
      RowBox[{
       RowBox[{"ssm", "[", 
        RowBox[{"3", ",", "i", ",", "L"}], "]"}], ".", 
       RowBox[{"ssm", "[", 
        RowBox[{"3", ",", "in", ",", "L"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", 
   RowBox[{"L_", ",", "J_", ",", "J2_", ",", "h_"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"H0", "[", 
      RowBox[{"L", ",", "J"}], "]"}], " ", "+", 
     RowBox[{"H1", "[", 
      RowBox[{"L", ",", "h"}], "]"}], "+", 
     RowBox[{"H2", "[", 
      RowBox[{"L", ",", "J2"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eV", "[", 
   RowBox[{"L_", ",", "J_", ",", "J2_", ",", "h_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"L", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"J", ",", "L"}], "]"}], ",", "J2", ",", "h"}], "]"}], "//", 
     "N"}], "//", "Eigenvalues"}], "//", "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eVR", "[", 
   RowBox[{"L_", ",", "J0_", ",", "J_", ",", "J2_", ",", "h_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"L", ",", 
       RowBox[{"J0", "+", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "J"}], ",", "J"}], "}"}], ",", "L"}], "]"}]}], ",", 
       "J2", ",", "h"}], "]"}], "//", "N"}], "//", "Eigenvalues"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eVR", "[", 
   RowBox[{"L_", ",", "J0_", ",", "J_", ",", "J2_", ",", "h_", ",", "k_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Eigenvalues", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"H", "[", 
       RowBox[{"L", ",", 
        RowBox[{"J0", "+", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "J"}], ",", "J"}], "}"}], ",", "L"}], "]"}]}], ",", 
        "J2", ",", "h"}], "]"}], "//", "N"}], ",", "k"}], "]"}], "//", 
   "Sort"}]}]}], "Input",
 CellChangeTimes->{{3.846054746436551*^9, 3.846054758689333*^9}, {
   3.846054841925749*^9, 3.84605493760248*^9}, {3.846054978814803*^9, 
   3.8460550074460382`*^9}, {3.846055048985506*^9, 3.8460550633652115`*^9}, {
   3.846055111836319*^9, 3.8460552317733946`*^9}, {3.846055307524617*^9, 
   3.8460553703638268`*^9}, {3.8460554479688683`*^9, 
   3.8460557461281147`*^9}, {3.846055804762884*^9, 3.846055836733515*^9}, {
   3.8460560481439314`*^9, 3.846056308428502*^9}, 3.8534969183633804`*^9, 
   3.853497002527996*^9, {3.853497071884754*^9, 3.8534971343777924`*^9}, {
   3.853497178441*^9, 3.8534972825364094`*^9}, {3.853497352533589*^9, 
   3.8534973717201385`*^9}, {3.853497402660784*^9, 3.8534974103755407`*^9}, {
   3.853497593691515*^9, 3.8534976609056835`*^9}, {3.8534980475399075`*^9, 
   3.8534980493832226`*^9}, {3.853498113254511*^9, 3.853498163069748*^9}, {
   3.8534986927037563`*^9, 3.8534986978442187`*^9}, {3.853498990773983*^9, 
   3.8534989910080748`*^9}, {3.853833953103306*^9, 3.853833975330945*^9}, {
   3.8538344941366596`*^9, 3.8538345045289516`*^9}, {3.8539349176162467`*^9, 
   3.8539349199893303`*^9}, {3.8539349853573885`*^9, 3.853935008180254*^9}, {
   3.8539987990312023`*^9, 3.8539987991962*^9}, {3.853998977086355*^9, 
   3.853999001270233*^9}, {3.855035221136097*^9, 3.8550352256774807`*^9}, {
   3.855587244153097*^9, 3.8555872445009055`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"217aa245-2c0e-4c94-b5c3-6b24065e3b89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Tr", "@", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"I", "*", 
     RowBox[{"H", "[", 
      RowBox[{"4", ",", 
       RowBox[{"{", 
        RowBox[{"0.592204", ",", 
         RowBox[{"-", "0.488366"}], ",", "0.00758383", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", ".3", ",", ".6"}], "]"}]}], 
    "]"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.865943389790408*^9, 3.8659434360133266`*^9}, {
  3.866024860537819*^9, 3.866024886630046*^9}, {3.866027263190292*^9, 
  3.8660272679244995`*^9}, {3.866029084609768*^9, 3.866029096864995*^9}, {
  3.8660292862903633`*^9, 3.8660293466098857`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"1117333f-9ba6-421d-8c06-860804a8a3ce"],

Cell[BoxData[
 TagBox[
  RowBox[{"2.242219871363191`", "\[VeryThinSpace]", "-", 
   RowBox[{"2.567250431926687`", " ", "\[ImaginaryI]"}]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.86594343640314*^9, 3.866024887795272*^9, 3.8660272685623875`*^9, {
   3.8660290894763184`*^9, 3.866029097390126*^9}, {3.8660292947679405`*^9, 
   3.866029347412755*^9}},
 CellLabel->
  "Out[86]//MatrixForm=",ExpressionUUID->"4eb668ae-6f24-421c-9c27-\
55a4f3acb393"]
}, Open  ]]
},
WindowSize->{810., 1377.75},
WindowMargins->{{-816, Automatic}, {-290.25, Automatic}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e9d92cd1-22e3-4891-be95-5b8f83515db5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3047, 77, 270, "Input",ExpressionUUID->"1611066d-f182-4e7e-9a85-52540d88081a"],
Cell[3608, 99, 5037, 134, 254, "Input",ExpressionUUID->"217aa245-2c0e-4c94-b5c3-6b24065e3b89"],
Cell[CellGroupData[{
Cell[8670, 237, 726, 16, 28, "Input",ExpressionUUID->"1117333f-9ba6-421d-8c06-860804a8a3ce"],
Cell[9399, 255, 493, 12, 45, "Output",ExpressionUUID->"4eb668ae-6f24-421c-9c27-55a4f3acb393"]
}, Open  ]]
}
]
*)

